

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Implants &mdash; SiestaTime beta documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Post. Servers" href="postservers.html" />
    <link rel="prev" title="Jobs,Logs" href="../hive/jobslogs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> SiestaTime
          

          
            
            <img src="../_static/STicon.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0b1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/hive.html">Hive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/client.html">Client</a></li>
</ul>
<p class="caption"><span class="caption-text">Adding Ressources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../resources/operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/vpc.html">Virtual Private Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/domains.html">Domains</a></li>
</ul>
<p class="caption"><span class="caption-text">Hive Status</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hive/jobslogs.html">Jobs,Logs</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Implants</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-a-module">What is a module?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-configurations">Basic Configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#time-to-live-ttl">Time to Live (TTL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#response-time">Response Time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#network-modules">Network Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#self-signed-https-go">Self-Signed HTTPS Go</a></li>
<li class="toctree-l3"><a class="reference internal" href="#paranoid-self-signed-https-go">Paranoid Self Signed HTTPS Go</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saas-gmail-api">SaaS: Gmail API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saas-gmail-api-mimic-https-client-fingenprints">SaaS: Gmail API,Mimic Https Client Fingenprints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#persistence-modules">Persistence Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#windows-schtaks">Windows - schtaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#darwin-launchd">Darwin - launchd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linux-xdg">Linux - XDG</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#redirectors">Redirectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#online">Online</a></li>
<li class="toctree-l3"><a class="reference internal" href="#offline">Offline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="postservers.html">Post. Servers</a></li>
</ul>
<p class="caption"><span class="caption-text">Interactions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../interactions/bichitos.html">Bichitos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/consolecommands.html">Job-Based Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/postinteractions.html">Post-Exploitation</a></li>
</ul>
<p class="caption"><span class="caption-text">Reporting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reporting/basicreport.html">Basic Reports</a></li>
</ul>
<p class="caption"><span class="caption-text">Concepts,Bugs and Dependencies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/bugs.html">Bugs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiestaTime</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Implants</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/deployment/implants.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="implants">
<h1>Implants<a class="headerlink" href="#implants" title="Permalink to this headline">¶</a></h1>
<p>Generate the different executables to keep connection to the foothold and their C2 (redirectors)</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/deployment/craftimplant.png"><img alt="../_images/craftimplant1.png" src="../_images/craftimplant1.png" /></a>
</div>
<div class="section" id="what-is-a-module">
<h2>What is a module?<a class="headerlink" href="#what-is-a-module" title="Permalink to this headline">¶</a></h2>
<p>Siesta Time provides you options that define essential properties of the implant.
For the moment modules can be chosen for both <code class="docutils literal notranslate"><span class="pre">egression</span></code> and <code class="docutils literal notranslate"><span class="pre">persistence</span></code>
In the future other modules could be chosen for more specific implant properties and behaviour once executed</p>
</div>
<div class="section" id="basic-configurations">
<h2>Basic Configurations<a class="headerlink" href="#basic-configurations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="time-to-live-ttl">
<h3>Time to Live (TTL)<a class="headerlink" href="#time-to-live-ttl" title="Permalink to this headline">¶</a></h3>
<p>Seconds to finish kill itself if the implant is not able to reach any of the redirectors</p>
</div>
<div class="section" id="response-time">
<h3>Response Time<a class="headerlink" href="#response-time" title="Permalink to this headline">¶</a></h3>
<p>Seconds to response to a job arrived through any redirector</p>
</div>
</div>
<div class="section" id="network-modules">
<h2>Network Modules<a class="headerlink" href="#network-modules" title="Permalink to this headline">¶</a></h2>
<p>Network modules are platform-agnostic. It defines the communication channel between the implant and the redirectors. Each module has its own parameters.</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/deployment/networkmodules.png"><img alt="../_images/networkmodules.png" src="../_images/networkmodules.png" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Every network module have his <code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">Infraestructure</span></code> version which let operators define IP/Domains that are not part of Hive battery. This will trigger the <code class="docutils literal notranslate"><span class="pre">Offline</span></code> mode to generate Implants. In this mode Hive will not deploy redirectors.</p>
</div>
<div class="section" id="self-signed-https-go">
<h3>Self-Signed HTTPS Go<a class="headerlink" href="#self-signed-https-go" title="Permalink to this headline">¶</a></h3>
<p>Https Client: Go
Redirector Certificate: Self Signed</p>
<p>TLS Port → Choose the Redirector https listening port</p>
</div>
<div class="section" id="paranoid-self-signed-https-go">
<h3>Paranoid Self Signed HTTPS Go<a class="headerlink" href="#paranoid-self-signed-https-go" title="Permalink to this headline">¶</a></h3>
<p>Https Client: Go
Redirector Certificate: Self Signed
The implant will check target redirector fingerprint</p>
<p>TLS Port → Choose the Redirector https listening port</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This module will avoid the implant to egress if there is a https TLS proxy on the middle</p>
</div>
</div>
<div class="section" id="saas-gmail-api">
<h3>SaaS: Gmail API<a class="headerlink" href="#saas-gmail-api" title="Permalink to this headline">¶</a></h3>
<p>Https Client: Go
Redirector Certificate: Google Servers</p>
</div>
<div class="section" id="saas-gmail-api-mimic-https-client-fingenprints">
<h3>SaaS: Gmail API,Mimic Https Client Fingenprints<a class="headerlink" href="#saas-gmail-api-mimic-https-client-fingenprints" title="Permalink to this headline">¶</a></h3>
<p>Https Client: Mimic target TLS Fingerprint
Redirector Certificate: Google Servers</p>
<p>UserAgent → Choose the client User Agent
TLS JA3C Fingerprint → Choose the Redirector TLS Fingerprint</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This module will try to evade most of NIDS non DPI (deep packet inspection) based</p>
</div>
</div>
</div>
<div class="section" id="persistence-modules">
<h2>Persistence Modules<a class="headerlink" href="#persistence-modules" title="Permalink to this headline">¶</a></h2>
<p>Once the red team achieve the execution of the implant through a delivery method the most important next step after checking C2 connectivity (or even before) will be to persist. This will let the implant to re-execute itself after any decive shutdon/re-login</p>
<div class="section" id="windows-schtaks">
<h3>Windows - schtaks<a class="headerlink" href="#windows-schtaks" title="Permalink to this headline">¶</a></h3>
<p>Use windows  C++ <code class="docutils literal notranslate"><span class="pre">comsupp.lib</span></code> and <code class="docutils literal notranslate"><span class="pre">taskschd.lib</span></code> to create a task that runs on user login</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/deployment/persistence.png"><img alt="../_images/persistence.png" src="../_images/persistence.png" /></a>
</div>
<p>Name → task name that will appear on windows task list
Path → Windows path for target Implant Binary ( <code class="docutils literal notranslate"><span class="pre">$(UserHOME)\“folder1\folder2\execuablenameand.extension</span></code> )</p>
</div>
<div class="section" id="darwin-launchd">
<h3>Darwin - launchd<a class="headerlink" href="#darwin-launchd" title="Permalink to this headline">¶</a></h3>
<p>Using Go file libraries, it writes a new launchd service. MacOSX will fetch it on user reboot/login and load the implant.</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/deployment/persistencelaunchd.png"><img alt="../_images/persistencelaunchd.png" src="../_images/persistencelaunchd.png" /></a>
</div>
<p>Name → Launchd file name that will appear on windows task list
Path → Darwin path for target Implant Binary  ( <code class="docutils literal notranslate"><span class="pre">$(UserHOME)/“folder1/folder2/execuablenameand.extension</span></code> )</p>
</div>
<div class="section" id="linux-xdg">
<h3>Linux - XDG<a class="headerlink" href="#linux-xdg" title="Permalink to this headline">¶</a></h3>
<p>User Desktop Linux devices with graphical interface respect some specification that let users to configure default tasks on user login.
Files are written using default GO file libraries.</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/deployment/persistencexdg.png"><img alt="../_images/persistencexdg.png" src="../_images/persistencexdg.png" /></a>
</div>
<p>Name → Autostart file name that will appear on windows task list
Path → Linux path for target Implant Binary ( <code class="docutils literal notranslate"><span class="pre">$(UserHOME)/“folder1/folder2/execuablenameand.extension</span></code> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Extra doc: <a class="reference external" href="https://specifications.freedesktop.org/autostart-spec/autostart-spec-latest.html">xdg</a></p>
</div>
</div>
</div>
<div class="section" id="redirectors">
<h2>Redirectors<a class="headerlink" href="#redirectors" title="Permalink to this headline">¶</a></h2>
<p>C2 Servers where implants try to connect to retrieve commands from Hive. Implants will try one by one to connect to them, once they find out which one the can reach by the previous network methods.</p>
<div class="section" id="online">
<h3>Online<a class="headerlink" href="#online" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/deployment/redsonline.png"><img alt="../_images/redsonline.png" src="../_images/redsonline.png" /></a>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Domains that are active already will not appear on the list</p>
</div>
</div>
<div class="section" id="offline">
<h3>Offline<a class="headerlink" href="#offline" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/deployment/redsoffline.png"><img alt="../_images/redsoffline.png" src="../_images/redsoffline.png" /></a>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="postservers.html" class="btn btn-neutral float-right" title="Post. Servers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../hive/jobslogs.html" class="btn btn-neutral float-left" title="Jobs,Logs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Alvaro Folgado

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>