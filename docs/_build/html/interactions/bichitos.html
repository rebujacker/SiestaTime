

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Bichitos &mdash; SiestaTime beta documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Post. Servers" href="postinteractions.html" />
    <link rel="prev" title="Implants" href="implants.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> SiestaTime
          

          
            
            <img src="../_static/STicon.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0b1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/hive.html">Hive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/client.html">Client</a></li>
</ul>
<p class="caption"><span class="caption-text">Adding Ressources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../resources/operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/vpc.html">Virtual Private Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/domains.html">Domains</a></li>
</ul>
<p class="caption"><span class="caption-text">Hive Status</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hive/jobslogs.html">Jobs,Logs</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deployment/implants.html">Implants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/postservers.html">Post. Servers</a></li>
</ul>
<p class="caption"><span class="caption-text">Interactions</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="implants.html">Implants</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bichitos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#list-bichitos-information">List Bichitos,Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jobs">Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logs">Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#interact-job-console">Interact - Job Console</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clear">clear</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resptime-seconds">respTime &lt;seconds&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ttl-seconds">ttl &lt;seconds&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exec-commandstring">exec &lt;commandString&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ls-pathfolder">ls &lt;pathFolder&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accesscheck-pathfile">accesscheck &lt;pathFile&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-pathfile">read &lt;pathfile&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#write-string-pathfile">write &lt;string&gt; &lt;pathfile&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wipe-pathfile">wipe &lt;pathfile&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upload-operator-pathfile-foothold-pathfile">upload &lt;operator-PathFile&gt; &lt;Foothold-Pathfile&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download-foothold-pathfile-operator-pathfile">download &lt;Foothold-pathfile&gt; &lt;operator-pathfile&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kill">kill</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removeinfection">removeInfection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#attach-bichitos-footholds-to-post-servers">Attach Bichitos/Footholds to Post. Servers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ssh-rev-shell">SSH Rev Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#empire">Empire</a></li>
<li class="toctree-l3"><a class="reference internal" href="#metasploit">Metasploit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="postinteractions.html">Post. Servers</a></li>
</ul>
<p class="caption"><span class="caption-text">Reporting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reporting/basicreport.html">Basic Reports</a></li>
</ul>
<p class="caption"><span class="caption-text">Concepts,Bugs and Dependencies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/bugs.html">Bugs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SiestaTime</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Bichitos</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/interactions/bichitos.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bichitos">
<h1>Bichitos<a class="headerlink" href="#bichitos" title="Permalink to this headline">¶</a></h1>
<p>Once the delivery of the implant (phishing, lv 2 mitm on the network, physical access…) is completed, Hive will start to receive Online Bichitos.</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/interactions/bichitoheader.png"><img alt="../_images/bichitoheader.png" src="../_images/bichitoheader.png" /></a>
</div>
<div class="section" id="list-bichitos-information">
<h2>List Bichitos,Information<a class="headerlink" href="#list-bichitos-information" title="Permalink to this headline">¶</a></h2>
<div class="figure align-right" style="width: 300px">
<a class="reference external image-reference" href="../_static/images/interactions/listbichitos.png"><img alt="../_images/listbichitos.png" src="../_images/listbichitos.png" /></a>
</div>
<p>The active footholds will appear under the Implant itself
They will be first organized by <strong>*Hostname*</strong>
Within each Hostname, Offline footholds (they were online and become offline)
Under Offline active Footholds will be ready to interact with.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A <code class="docutils literal notranslate"><span class="pre">Offline</span></code> bichito or foothold, will be determined if a job is sent, and no response back from any redirector is obtained in <code class="docutils literal notranslate"><span class="pre">respTime</span></code> <strong>*[more details on the developers’ guide]*</strong></p>
</div>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/interactions/bichitoinfo.png"><img alt="../_images/bichitoinfo.png" src="../_images/bichitoinfo.png" /></a>
</div>
<ul class="simple">
<li><dl class="first docutils">
<dt>Params.</dt>
<dd><ul class="first last">
<li>ID → Target IMplant process ID</li>
<li>PID → Target foothold PID for bichito</li>
<li>Architecture → target hardware process arch</li>
<li>Mac Addr</li>
<li>OS Version</li>
<li>Hostname</li>
<li>UserName → the user context that the bichito is executed with</li>
<li>AdminRoot → will show how privileged the process is in the target OS</li>
<li>Redirector attached → Last redirector where the foothold connected to</li>
<li>Status → Offline if no response within responseTime</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="jobs">
<h2>Jobs<a class="headerlink" href="#jobs" title="Permalink to this headline">¶</a></h2>
<p>Similarly to Hive Jobs, this log will show jobs that are being sent to be processed by target foothold</p>
</div>
<div class="section" id="logs">
<h2>Logs<a class="headerlink" href="#logs" title="Permalink to this headline">¶</a></h2>
<p>Error log generated by the foothold, for example, when it is unable to connect to one redirector</p>
</div>
<div class="section" id="interact-job-console">
<h2>Interact - Job Console<a class="headerlink" href="#interact-job-console" title="Permalink to this headline">¶</a></h2>
<p>This is the main Job-based console of Siesta Time
Jobs are sent to the Hive, then the Hive detects which redirector the foothold is attached to, and finally the foothold grabs the Job and response back in <code class="docutils literal notranslate"><span class="pre">respTime</span></code>
Results will be shown in the Bichito’s Job Log</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/interactions/bichitoconsole.png"><img alt="../_images/bichitoconsole.png" src="../_images/bichitoconsole.png" /></a>
</div>
<div class="section" id="clear">
<h3>clear<a class="headerlink" href="#clear" title="Permalink to this headline">¶</a></h3>
<p>Clear JS console</p>
</div>
<div class="section" id="resptime-seconds">
<h3>respTime &lt;seconds&gt;<a class="headerlink" href="#resptime-seconds" title="Permalink to this headline">¶</a></h3>
<p>Change target Bichito respTime to target integer in seconds</p>
</div>
<div class="section" id="ttl-seconds">
<h3>ttl &lt;seconds&gt;<a class="headerlink" href="#ttl-seconds" title="Permalink to this headline">¶</a></h3>
<p>Change the time to live of the target Bichito to target integer seconds</p>
</div>
<div class="section" id="exec-commandstring">
<h3>exec &lt;commandString&gt;<a class="headerlink" href="#exec-commandstring" title="Permalink to this headline">¶</a></h3>
<p>Pass target string to default command interpreter (sh/bash/cmd) and retrieve output</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/interactions/exec.png"><img alt="../_images/exec.png" src="../_images/exec.png" /></a>
</div>
<p>EG.: <code class="docutils literal notranslate"><span class="pre">exec</span> <span class="pre">ipconfig</span></code></p>
</div>
<div class="section" id="ls-pathfolder">
<h3>ls &lt;pathFolder&gt;<a class="headerlink" href="#ls-pathfolder" title="Permalink to this headline">¶</a></h3>
<p>List target foothold Folder</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/interactions/ls.png"><img alt="../_images/ls.png" src="../_images/ls.png" /></a>
</div>
<p>EG.: <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">C:\\</span></code></p>
</div>
<div class="section" id="accesscheck-pathfile">
<h3>accesscheck &lt;pathFile&gt;<a class="headerlink" href="#accesscheck-pathfile" title="Permalink to this headline">¶</a></h3>
<p>Provide target operating system’s file access control rules as an output</p>
<div class="figure align-center" style="width: 600px">
<a class="reference external image-reference" href="../_static/images/interactions/accesschk.png"><img alt="../_images/accesschk.png" src="../_images/accesschk.png" /></a>
</div>
<p>EG.: <code class="docutils literal notranslate"><span class="pre">accesschk</span> <span class="pre">C:\\windows\system32\calc.exe</span></code></p>
</div>
<div class="section" id="read-pathfile">
<h3>read &lt;pathfile&gt;<a class="headerlink" href="#read-pathfile" title="Permalink to this headline">¶</a></h3>
<p>Read bytes of target file and retrieve the output</p>
</div>
<div class="section" id="write-string-pathfile">
<h3>write &lt;string&gt; &lt;pathfile&gt;<a class="headerlink" href="#write-string-pathfile" title="Permalink to this headline">¶</a></h3>
<p>Write string on target File. If a file exists, it will append at the end.</p>
</div>
<div class="section" id="wipe-pathfile">
<h3>wipe &lt;pathfile&gt;<a class="headerlink" href="#wipe-pathfile" title="Permalink to this headline">¶</a></h3>
<p>Wipe target file. Will transform its bytes to 0 and then remove the disk header.</p>
</div>
<div class="section" id="upload-operator-pathfile-foothold-pathfile">
<h3>upload &lt;operator-PathFile&gt; &lt;Foothold-Pathfile&gt;<a class="headerlink" href="#upload-operator-pathfile-foothold-pathfile" title="Permalink to this headline">¶</a></h3>
<p>Upload Operators source file to target foothold location</p>
<p>EG.: <code class="docutils literal notranslate"><span class="pre">upload</span> <span class="pre">/home/rebujacker/upload1</span> <span class="pre">C:\\Users\test\Desktop\</span></code></p>
</div>
<div class="section" id="download-foothold-pathfile-operator-pathfile">
<h3>download &lt;Foothold-pathfile&gt; &lt;operator-pathfile&gt;<a class="headerlink" href="#download-foothold-pathfile-operator-pathfile" title="Permalink to this headline">¶</a></h3>
<p>Download target foothold file to a operator folder</p>
<p>EG.: <code class="docutils literal notranslate"><span class="pre">download</span> <span class="pre">C:\\Users\test\Desktop\download1</span> <span class="pre">/home/rebujacker/download1</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Every Output is set to hold a maximum of 20 Megabytes. For moving bigger blobs of data you need to use POST./Staging Servers</p>
</div>
</div>
<div class="section" id="kill">
<h3>kill<a class="headerlink" href="#kill" title="Permalink to this headline">¶</a></h3>
<p>Kill actual bichito process</p>
</div>
<div class="section" id="removeinfection">
<h3>removeInfection<a class="headerlink" href="#removeinfection" title="Permalink to this headline">¶</a></h3>
<p>If the implant was configured to hold a persistence on target foothold, this command will:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Steps</dt>
<dd><ul class="first last">
<li>Remove/Wipe Persistence configurations/files</li>
<li>Remove/Wipe executable on disk, if applicable.</li>
<li>Kill the actual bichito process</li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command output will be always “Processing” since the target foothold will never answer back after removal</p>
</div>
</div>
</div>
<div class="section" id="attach-bichitos-footholds-to-post-servers">
<h2>Attach Bichitos/Footholds to Post. Servers<a class="headerlink" href="#attach-bichitos-footholds-to-post-servers" title="Permalink to this headline">¶</a></h2>
<div class="figure align-right" style="width: 300px">
<a class="reference external image-reference" href="../_static/images/interactions/inject.png"><img alt="../_images/inject.png" src="../_images/inject.png" /></a>
</div>
<p>Once the foothold is running one of your implant processes (Bichitos) the natural way to interact for non basic operations will be the Post./Staging Servers that can be created/deleted at any moment.
For the moment, these attacks/injections come in the following way:</p>
<div class="section" id="ssh-rev-shell">
<h3>SSH Rev Shell<a class="headerlink" href="#ssh-rev-shell" title="Permalink to this headline">¶</a></h3>
<p>Create a new thread from the actual Bichito process.
This thread will create an outbound SSH client request against a target previously created “Rev SSH Handler”</p>
</div>
<div class="section" id="empire">
<h3>Empire<a class="headerlink" href="#empire" title="Permalink to this headline">¶</a></h3>
<p>Generate a launcher that will be executed by a bichito thread using “Exec” and “python”. Python needs to be installed on target foothold previously.</p>
</div>
<div class="section" id="metasploit">
<h3>Metasploit<a class="headerlink" href="#metasploit" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">TBD</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These attack/Injections normally have a Offline option, that will let Operators to build their own Post. Servers without hive</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">For the moment these actions are not creating new processes, or injecting in other’s processes, that is <code class="docutils literal notranslate"><span class="pre">TBD</span></code></p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="postinteractions.html" class="btn btn-neutral float-right" title="Post. Servers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="implants.html" class="btn btn-neutral float-left" title="Implants" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Alvaro Folgado

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>